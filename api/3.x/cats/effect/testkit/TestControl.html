<!DOCTYPE html ><html><head><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/><title></title><meta content="" name="description"/><meta content="" name="keywords"/><meta http-equiv="content-type" content="text/html; charset=UTF-8"/><link href="../../../lib/index.css" media="screen" type="text/css" rel="stylesheet"/><link href="../../../lib/template.css" media="screen" type="text/css" rel="stylesheet"/><link href="../../../lib/print.css" media="print" type="text/css" rel="stylesheet"/><link href="../../../lib/diagrams.css" media="screen" type="text/css" rel="stylesheet" id="diagrams-css"/><script type="text/javascript" src="../../../lib/jquery.min.js"></script><script type="text/javascript" src="../../../lib/index.js"></script><script type="text/javascript" src="../../../index.js"></script><script type="text/javascript" src="../../../lib/scheduler.js"></script><script type="text/javascript" src="../../../lib/template.js"></script><script type="text/javascript">/* this variable can be used by the JS to determine the path to the root document */
var toRoot = '../../../';</script></head><body><div id="search"><span id="doc-title"><span id="doc-version"></span></span> <span class="close-results"><span class="left">&lt;</span> Back</span><div id="textfilter"><span class="input"><input autocapitalize="none" placeholder="Search" id="index-input" type="text" accesskey="/"/><i class="clear material-icons"></i><i id="search-icon" class="material-icons"></i></span></div></div><div id="search-results"><div id="search-progress"><div id="progress-fill"></div></div><div id="results-content"><div id="entity-results"></div><div id="member-results"></div></div></div><div id="content-scroll-container" style="-webkit-overflow-scrolling: touch;"><div id="content-container" style="-webkit-overflow-scrolling: touch;"><div id="subpackage-spacer"><div id="packages"><h1>Packages</h1><ul><li class="indented0 " name="_root_.root" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="_root_" class="anchorToMember"></a><a id="root:_root_" class="anchorToMember"></a> <span class="permalink"><a href="../../../index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="../../../index.html" title=""><span class="name">root</span></a></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd><a href="../../../index.html" name="_root_" id="_root_" class="extype">root</a></dd></dl></div></li><li class="indented1 " name="_root_.cats" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="cats" class="anchorToMember"></a><a id="cats:cats" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="../../index.html" title=""><span class="name">cats</span></a></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd><a href="../../../index.html" name="_root_" id="_root_" class="extype">root</a></dd></dl></div></li><li class="indented2 " name="cats.effect" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="effect" class="anchorToMember"></a><a id="effect:effect" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="../index.html" title=""><span class="name">effect</span></a></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd><a href="../../index.html" name="cats" id="cats" class="extype">cats</a></dd></dl></div></li><li class="indented3 " name="cats.effect.testkit" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="testkit" class="anchorToMember"></a><a id="testkit:testkit" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="index.html" title=""><span class="name">testkit</span></a></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd><a href="../index.html" name="cats.effect" id="cats.effect" class="extype">effect</a></dd></dl></div></li><li class="current-entities indented3"><a href="TestControl$.html" title="" class="object"></a> <a href="" title="Implements a fully functional single-threaded runtime for a cats.effect.IO program." class="class"></a><a href="" title="Implements a fully functional single-threaded runtime for a cats.effect.IO program.">TestControl</a></li><li class="current-entities indented3"><span class="separator"></span> <a href="TestException.html" title="" class="class"></a><a href="TestException.html" title="">TestException</a></li><li class="current-entities indented3"><span class="separator"></span> <a href="TestInstances.html" title="" class="trait"></a><a href="TestInstances.html" title="">TestInstances</a></li></ul></div></div><div id="content"><body class="class type"><div id="definition"><a href="TestControl$.html" title="See companion object"><div class="big-circle class-companion-object">c</div></a><p id="owner"><a href="../../index.html" name="cats" id="cats" class="extype">cats</a>.<a href="../index.html" name="cats.effect" id="cats.effect" class="extype">effect</a>.<a href="index.html" name="cats.effect.testkit" id="cats.effect.testkit" class="extype">testkit</a></p><h1><a href="TestControl$.html" title="See companion object">TestControl</a><span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html" title="Permalink"><i class="material-icons"></i></a></span></h1><h3><span class="morelinks"><div>Companion <a href="TestControl$.html" title="See companion object">object TestControl</a></div></span></h3></div><h4 id="signature" class="signature"><span class="modifier_kind"><span class="modifier">final </span> <span class="kind">class</span></span> <span class="symbol"><span class="name">TestControl</span><span class="tparams">[<span name="A">A</span>]</span><span class="result"> extends <a href="https://www.scala-lang.org/api/2.13.10/scala/AnyRef.html#scala.AnyRef" name="scala.AnyRef" id="scala.AnyRef" class="extype">AnyRef</a></span></span></h4><div id="comment" class="fullcommenttop"><div class="comment cmt"><p>Implements a fully functional single-threaded runtime for a <a href="../IO.html" name="cats.effect.IO" id="cats.effect.IO" class="extype">cats.effect.IO</a> program. When
using this control system, <code>IO</code> programs will be executed on a single JVM thread, <i>similar</i>
to how they would behave if the production runtime were configured to use a single worker
thread regardless of underlying physical thread count. The results of the underlying <code>IO</code>
will be produced by the <a href="#results:cats.effect.IO[Option[cats.effect.Outcome[cats.Id,Throwable,A]]]" name="cats.effect.testkit.TestControl#results" id="cats.effect.testkit.TestControl#results" class="extmbr">results</a> effect when ready, but nothing will actually evaluate
until one of the <i>tick</i> effects on this class are sequenced. If the desired behavior is to
simply run the <code>IO</code> fully to completion within the mock environment, respecting monotonic
time, then <a href="#tickAll:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tickAll" id="cats.effect.testkit.TestControl#tickAll" class="extmbr">tickAll</a> is likely the desired effect (or, alternatively,
<a href="TestControl$.html#executeEmbed[A](program:cats.effect.IO[A],config:cats.effect.unsafe.IORuntimeConfig,seed:Option[String]):cats.effect.IO[A]" name="cats.effect.testkit.TestControl#executeEmbed" id="cats.effect.testkit.TestControl#executeEmbed" class="extmbr">TestControl.executeEmbed</a>).</p><p>In other words, <code>TestControl</code> is sort of like a "handle" to the runtime internals within the
context of a specific <code>IO</code>'s execution. It makes it possible for users to manipulate and
observe the execution of the <code>IO</code> under test from an external vantage point. It is important
to understand that the <i>outer</i> <code>IO</code>s (e.g. those returned by the <a href="#tick:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tick" id="cats.effect.testkit.TestControl#tick" class="extmbr">tick</a> or <a href="#results:cats.effect.IO[Option[cats.effect.Outcome[cats.Id,Throwable,A]]]" name="cats.effect.testkit.TestControl#results" id="cats.effect.testkit.TestControl#results" class="extmbr">results</a>
methods) are <i>not</i> running under the test control environment, and instead they are meant
to be run by some outer runtime. Interactions between the outer runtime and the inner runtime
(potentially via mechanisms like <a href="../std/Queue.html" name="cats.effect.std.Queue" id="cats.effect.std.Queue" class="extype">cats.effect.std.Queue</a> or
<a href="../kernel/Deferred.html" name="cats.effect.kernel.Deferred" id="cats.effect.kernel.Deferred" class="extype">cats.effect.kernel.Deferred</a>) are quite tricky and should only be done with extreme care.
The likely outcome in such scenarios is that the <code>TestControl</code> runtime will detect the inner
<code>IO</code> as being deadlocked whenever it is actually waiting on the external runtime. This could
result in strange effects such as <a href="#tickAll:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tickAll" id="cats.effect.testkit.TestControl#tickAll" class="extmbr">tickAll</a> or <code>executeEmbed</code> terminating early. Do not
construct such scenarios unless you're very confident you understand the implications of what
you're doing.</p><p>Where things <i>differ</i> from a single-threaded production runtime is in two critical areas.</p><p>First, whenever multiple fibers are outstanding and ready to be resumed, the <code>TestControl</code>
runtime will <i>randomly</i> choose between them, rather than taking them in a first-in,
first-out fashion as the default production runtime will. This semantic is intended to
simulate different scheduling interleavings, ensuring that race conditions are not
accidentally masked by deterministic execution order.</p><p>Second, within the context of the <code>TestControl</code>, <i>time</i> is very carefully and artificially
controlled. In a sense, this runtime behaves as if it is executing on a single CPU which
performs all operations infinitely fast. Any fibers which are immediately available for
execution will be executed until no further fibers are available to run (assuming the use of
<code>tickAll</code>). Through this entire process, the current clock (which is exposed to the program
via <a href="../IO$.html#realTime:cats.effect.IO[scala.concurrent.duration.FiniteDuration]" name="cats.effect.IO#realTime" id="cats.effect.IO#realTime" class="extmbr">IO.realTime</a> and <a href="../IO$.html#monotonic:cats.effect.IO[scala.concurrent.duration.FiniteDuration]" name="cats.effect.IO#monotonic" id="cats.effect.IO#monotonic" class="extmbr">IO.monotonic</a>) will remain fixed at the very beginning, meaning
that no time is considered to have elapsed as a consequence of <i>compute</i>.</p><p>Note that the above means that it is relatively easy to create a deadlock on this runtime
with a program which would not deadlock on either the JVM or JavaScript:</p><pre><span class="cmt">// do not do this!</span>
IO.cede.foreverM.timeout(<span class="num">10.</span>millis)</pre><p>The above program spawns a fiber which yields forever, setting a timeout for 10 milliseconds
which is <i>intended</i> to bring the loop to a halt. However, because the immediate task queue
will never be empty, the test runtime will never advance time, meaning that the 10
milliseconds will never elapse and the timeout will not be hit. This will manifest as the
<a href="#tick:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tick" id="cats.effect.testkit.TestControl#tick" class="extmbr">tick</a> and <a href="#tickAll:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tickAll" id="cats.effect.testkit.TestControl#tickAll" class="extmbr">tickAll</a> effects simply running forever and not returning if called.
<a href="#tickOne:cats.effect.IO[Boolean]" name="cats.effect.testkit.TestControl#tickOne" id="cats.effect.testkit.TestControl#tickOne" class="extmbr">tickOne</a> is safe to call on the above program, but it will always produce <code>true</code>.</p><p>In order to advance time, you must use the <a href="#advance(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#advance" id="cats.effect.testkit.TestControl#advance" class="extmbr">advance</a> effect to move the clock forward by a
specified offset (which must be greater than 0). If you use the <code>tickAll</code> effect, the clock
will be automatically advanced by the minimum amount necessary to reach the next pending
task. For example, if the program contains an <a href="../IO$.html#sleep(delay:scala.concurrent.duration.Duration):cats.effect.IO[Unit]" name="cats.effect.IO#sleep" id="cats.effect.IO#sleep" class="extmbr">IO.sleep(delay*</a> for <code>500.millis</code>, and there
are no shorter sleeps, then time will need to be advanced by 500 milliseconds in order to
make that fiber eligible for execution.</p><p>At this point, the process repeats until all tasks are exhausted. If the program has reached
a concluding value or exception, then it will be produced from the <code>unsafeRun</code> method which
scheduled the <code>IO</code> on the runtime (pro tip: do <i>not</i> use <code>unsafeRunSync</code> with this runtime,
since it will always result in immediate deadlock). If the program does <i>not</i> produce a
result but also has no further work to perform (such as a program like <a href="../IO$.html#never[A]:cats.effect.IO[A]" name="cats.effect.IO#never" id="cats.effect.IO#never" class="extmbr">IO.never</a>), then
<code>tickAll</code> will return but no result will have been produced by the <code>unsafeRun</code>. If this
happens, <a href="#isDeadlocked:cats.effect.IO[Boolean]" name="cats.effect.testkit.TestControl#isDeadlocked" id="cats.effect.testkit.TestControl#isDeadlocked" class="extmbr">isDeadlocked</a> will return <code>true</code> and the program is in a "hung" state. This same
situation on the production runtime would have manifested as an asynchronous deadlock.</p><p>You should <i>never</i> use this runtime in a production code path. It is strictly meant for
testing purposes, particularly testing programs that involve time functions and
<a href="../IO$.html#sleep(delay:scala.concurrent.duration.Duration):cats.effect.IO[Unit]" name="cats.effect.IO#sleep" id="cats.effect.IO#sleep" class="extmbr">IO.sleep(delay*</a>.</p><p>Due to the semantics of this runtime, time will behave entirely consistently with a plausible
production execution environment provided that you <i>never</i> observe time via side-effects,
and exclusively through the <a href="../IO$.html#realTime:cats.effect.IO[scala.concurrent.duration.FiniteDuration]" name="cats.effect.IO#realTime" id="cats.effect.IO#realTime" class="extmbr">IO.realTime</a>, <a href="../IO$.html#monotonic:cats.effect.IO[scala.concurrent.duration.FiniteDuration]" name="cats.effect.IO#monotonic" id="cats.effect.IO#monotonic" class="extmbr">IO.monotonic</a>, and <a href="../IO$.html#sleep(delay:scala.concurrent.duration.Duration):cats.effect.IO[Unit]" name="cats.effect.IO#sleep" id="cats.effect.IO#sleep" class="extmbr">IO.sleep(delay*</a>
functions (and other functions built on top of these). From the perspective of these
functions, all computation is infinitely fast, and the only effect which advances time is
<a href="../IO$.html#sleep(delay:scala.concurrent.duration.Duration):cats.effect.IO[Unit]" name="cats.effect.IO#sleep" id="cats.effect.IO#sleep" class="extmbr">IO.sleep(delay*</a> (or if something external, such as the test harness, sequences the
<a href="#advance(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#advance" id="cats.effect.testkit.TestControl#advance" class="extmbr">advance</a> effect). However, an effect such as <code>IO(System.currentTimeMillis())</code> will "see
through" the illusion, since the system clock is unaffected by this runtime. This is one
reason why it is important to always and exclusively rely on <code>realTime</code> and <code>monotonic</code>,
either directly on <code>IO</code> or via the typeclass abstractions.</p><p>WARNING: <i>Never</i> use this runtime on programs which use the <a href="../IO.html#evalOn(ec:scala.concurrent.ExecutionContext):cats.effect.IO[A]" name="cats.effect.IO#evalOn" id="cats.effect.IO#evalOn" class="extmbr">IO#evalOn</a> method! The test
runtime will detect this situation as an asynchronous deadlock.
</p></div><dl class="attributes block"><dt>Source</dt><dd><a href="https://github.com/typelevel/cats-effect/blob/3ce51c22617690b2e2c483a1d50794e684615877/testkit/shared/src/main/scala/cats/effect/testkit/TestControl.scala" target="_blank">TestControl.scala</a></dd><dt>See also</dt><dd><span class="cmt"><p>
  <a href="../kernel/Clock.html" name="cats.effect.kernel.Clock" id="cats.effect.kernel.Clock" class="extype">cats.effect.kernel.Clock</a></p></span><span class="cmt"><p>
  <a href="#tickAll:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tickAll" id="cats.effect.testkit.TestControl#tickAll" class="extmbr">tickAll</a></p></span></dd></dl><div class="toggleContainer"><div class="toggle block"><span>Linear Supertypes</span><div class="superTypes hiddenContent"><a href="https://www.scala-lang.org/api/2.13.10/scala/AnyRef.html#scala.AnyRef" name="scala.AnyRef" id="scala.AnyRef" class="extype">AnyRef</a>, <a href="https://www.scala-lang.org/api/2.13.10/scala/Any.html#scala.Any" name="scala.Any" id="scala.Any" class="extype">Any</a></div></div></div></div><div id="mbrsel"><div class="toggle"></div><div id="memberfilter"><i class="material-icons arrow"></i><span class="input"><input placeholder="Filter all members" id="mbrsel-input" type="text" accesskey="/"/></span><i class="clear material-icons"></i></div><div id="filterby"><div id="order"><span class="filtertype">Ordering</span><ol><li class="alpha in"><span>Alphabetic</span></li><li class="inherit out"><span>By Inheritance</span></li></ol></div><div class="ancestors"><span class="filtertype">Inherited<br/></span><ol id="linearization"><li class="in" name="cats.effect.testkit.TestControl"><span>TestControl</span></li><li class="in" name="scala.AnyRef"><span>AnyRef</span></li><li class="in" name="scala.Any"><span>Any</span></li></ol></div><div class="ancestors"><span class="filtertype"></span><ol><li class="hideall out"><span>Hide All</span></li><li class="showall in"><span>Show All</span></li></ol></div><div id="visbl"><span class="filtertype">Visibility</span><ol><li class="public in"><span>Public</span></li><li class="protected out"><span>Protected</span></li></ol></div></div></div><div id="template"><div id="allMembers"><div class="values members"><h3>Value Members</h3><ol><li class="indented0 " name="scala.AnyRef#!=" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="!=(x$1:Any):Boolean" class="anchorToMember"></a><a id="!=(Any):Boolean" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#!=(x$1:Any):Boolean" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name" title="gt4s: $bang$eq">!=</span><span class="params">(<span name="arg0">arg0: <a href="https://www.scala-lang.org/api/2.13.10/scala/Any.html#scala.Any" name="scala.Any" id="scala.Any" class="extype">Any</a></span>)</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Boolean.html#scala.Boolean" name="scala.Boolean" id="scala.Boolean" class="extype">Boolean</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div></li><li class="indented0 " name="scala.AnyRef###" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="##:Int" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html###:Int" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name" title="gt4s: $hash$hash">##</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Int.html#scala.Int" name="scala.Int" id="scala.Int" class="extype">Int</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div></li><li class="indented0 " name="scala.AnyRef#==" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="==(x$1:Any):Boolean" class="anchorToMember"></a><a id="==(Any):Boolean" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#==(x$1:Any):Boolean" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name" title="gt4s: $eq$eq">==</span><span class="params">(<span name="arg0">arg0: <a href="https://www.scala-lang.org/api/2.13.10/scala/Any.html#scala.Any" name="scala.Any" id="scala.Any" class="extype">Any</a></span>)</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Boolean.html#scala.Boolean" name="scala.Boolean" id="scala.Boolean" class="extype">Boolean</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div></li><li class="indented0 " name="cats.effect.testkit.TestControl#advance" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="advance(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" class="anchorToMember"></a><a id="advance(FiniteDuration):IO[Unit]" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#advance(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">def</span></span> <span class="symbol"><span class="name">advance</span><span class="params">(<span name="time">time: <a href="https://www.scala-lang.org/api/2.13.10/scala/concurrent/duration/FiniteDuration.html#scala.concurrent.duration.FiniteDuration" name="scala.concurrent.duration.FiniteDuration" id="scala.concurrent.duration.FiniteDuration" class="extype">FiniteDuration</a></span>)</span><span class="result">: <a href="../IO.html" name="cats.effect.IO" id="cats.effect.IO" class="extype">IO</a>[<a href="https://www.scala-lang.org/api/2.13.10/scala/Unit.html#scala.Unit" name="scala.Unit" id="scala.Unit" class="extype">Unit</a>]</span></span><p class="shortcomment cmt">Advances the runtime clock by the specified amount (which must be positive).</p><div class="fullcomment"><div class="comment cmt"><p>Advances the runtime clock by the specified amount (which must be positive). Does not
execute any fibers, though may result in some previously-sleeping fibers to become pending
and eligible for execution in the next <a href="#tick:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tick" id="cats.effect.testkit.TestControl#tick" class="extmbr">tick</a>.
</p></div></div></li><li class="indented0 " name="cats.effect.testkit.TestControl#advanceAndTick" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="advanceAndTick(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" class="anchorToMember"></a><a id="advanceAndTick(FiniteDuration):IO[Unit]" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#advanceAndTick(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">def</span></span> <span class="symbol"><span class="name">advanceAndTick</span><span class="params">(<span name="time">time: <a href="https://www.scala-lang.org/api/2.13.10/scala/concurrent/duration/FiniteDuration.html#scala.concurrent.duration.FiniteDuration" name="scala.concurrent.duration.FiniteDuration" id="scala.concurrent.duration.FiniteDuration" class="extype">FiniteDuration</a></span>)</span><span class="result">: <a href="../IO.html" name="cats.effect.IO" id="cats.effect.IO" class="extype">IO</a>[<a href="https://www.scala-lang.org/api/2.13.10/scala/Unit.html#scala.Unit" name="scala.Unit" id="scala.Unit" class="extype">Unit</a>]</span></span><p class="shortcomment cmt">A convenience effect which advances time by the specified amount and then ticks once.</p><div class="fullcomment"><div class="comment cmt"><p>A convenience effect which advances time by the specified amount and then ticks once. Note
that this method is very subtle and will often <i>not</i> do what you think it should. For
example:</p><pre><span class="cmt">// will never print!</span>
<span class="kw">val</span> program = IO.sleep(<span class="num">100.</span>millis) *&gt; IO.println(<span class="lit">"Hello, World!"</span>)

TestControl.execute(program).flatMap(_.advanceAndTick(<span class="num">1.</span>second))</pre><p>This is very subtle, but the problem is that time is advanced <i>before</i> the
<a href="../IO$.html#sleep(delay:scala.concurrent.duration.Duration):cats.effect.IO[Unit]" name="cats.effect.IO#sleep" id="cats.effect.IO#sleep" class="extmbr">IO.sleep(delay*</a> even has a chance to get scheduled! This means that when <code>sleep</code> is
finally submitted to the runtime, it is scheduled for the time offset equal to <code>1.second +
100.millis</code>, since time was already advanced <code>1.second</code> before it had a chance to submit.
Of course, time has only been advanced by <code>1.second</code>, thus the <code>sleep</code> never completes and
the <code>println</code> cannot ever run.</p><p>There are two possible solutions to this problem: either sequence <a href="#tick:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tick" id="cats.effect.testkit.TestControl#tick" class="extmbr">tick</a> <i>first</i>
(before sequencing <code>advanceAndTick</code>) to ensure that the <code>sleep</code> has a chance to schedule
itself, or simply use <a href="#tickAll:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tickAll" id="cats.effect.testkit.TestControl#tickAll" class="extmbr">tickAll</a> if you do not need to run assertions between time
windows.</p><p>In most cases, <a href="#tickFor(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tickFor" id="cats.effect.testkit.TestControl#tickFor" class="extmbr">tickFor</a> will provide a more intuitive execution semantic.
</p></div><dl class="attributes block"><dt>See also</dt><dd><span class="cmt"><p>
  <a href="#advance(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#advance" id="cats.effect.testkit.TestControl#advance" class="extmbr">advance</a></p></span><span class="cmt"><p>
  <a href="#tick:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tick" id="cats.effect.testkit.TestControl#tick" class="extmbr">tick</a></p></span><span class="cmt"><p>
  <a href="#tickFor(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tickFor" id="cats.effect.testkit.TestControl#tickFor" class="extmbr">tickFor</a></p></span></dd></dl></div></li><li class="indented0 " name="scala.Any#asInstanceOf" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="asInstanceOf[T0]:T0" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#asInstanceOf[T0]:T0" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name">asInstanceOf</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="result">: <span name="scala.Any.asInstanceOf.T0" class="extype">T0</span></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>Any</dd></dl></div></li><li class="indented0 " name="scala.AnyRef#clone" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="prt"><a id="clone():Object" class="anchorToMember"></a><a id="clone():AnyRef" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#clone():Object" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">def</span></span> <span class="symbol"><span class="name">clone</span><span class="params">()</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/AnyRef.html#scala.AnyRef" name="scala.AnyRef" id="scala.AnyRef" class="extype">AnyRef</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Attributes</dt><dd>protected[<span name="java.lang" class="extype">lang</span>] </dd><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd><span class="name">@throws</span><span class="args">(<span><span class="defval">classOf[java.lang.CloneNotSupportedException]</span></span>)</span> <span class="name">@native</span><span class="args">()</span> </dd></dl></div></li><li class="indented0 " name="scala.AnyRef#eq" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="eq(x$1:AnyRef):Boolean" class="anchorToMember"></a><a id="eq(AnyRef):Boolean" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#eq(x$1:AnyRef):Boolean" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name">eq</span><span class="params">(<span name="arg0">arg0: <a href="https://www.scala-lang.org/api/2.13.10/scala/AnyRef.html#scala.AnyRef" name="scala.AnyRef" id="scala.AnyRef" class="extype">AnyRef</a></span>)</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Boolean.html#scala.Boolean" name="scala.Boolean" id="scala.Boolean" class="extype">Boolean</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef</dd></dl></div></li><li class="indented0 " name="scala.AnyRef#equals" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="equals(x$1:Object):Boolean" class="anchorToMember"></a><a id="equals(AnyRef):Boolean" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#equals(x$1:Object):Boolean" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">def</span></span> <span class="symbol"><span class="name">equals</span><span class="params">(<span name="arg0">arg0: <a href="https://www.scala-lang.org/api/2.13.10/scala/AnyRef.html#scala.AnyRef" name="scala.AnyRef" id="scala.AnyRef" class="extype">AnyRef</a></span>)</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Boolean.html#scala.Boolean" name="scala.Boolean" id="scala.Boolean" class="extype">Boolean</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div></li><li class="indented0 " name="scala.AnyRef#finalize" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="prt"><a id="finalize():Unit" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#finalize():Unit" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">def</span></span> <span class="symbol"><span class="name">finalize</span><span class="params">()</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Unit.html#scala.Unit" name="scala.Unit" id="scala.Unit" class="extype">Unit</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Attributes</dt><dd>protected[<span name="java.lang" class="extype">lang</span>] </dd><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd><span class="name">@throws</span><span class="args">(<span><span class="symbol">classOf[java.lang.Throwable]</span></span>)</span> </dd></dl></div></li><li class="indented0 " name="scala.AnyRef#getClass" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="getClass():Class[_]" class="anchorToMember"></a><a id="getClass():Class[_&lt;:AnyRef]" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#getClass():Class[_]" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name">getClass</span><span class="params">()</span><span class="result">: <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/lang/Class.html#java.lang.Class" name="java.lang.Class" id="java.lang.Class" class="extype">Class</a>[_ &lt;: <a href="https://www.scala-lang.org/api/2.13.10/scala/AnyRef.html#scala.AnyRef" name="scala.AnyRef" id="scala.AnyRef" class="extype">AnyRef</a>]</span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef → Any</dd><dt>Annotations</dt><dd><span class="name">@native</span><span class="args">()</span> </dd></dl></div></li><li class="indented0 " name="scala.AnyRef#hashCode" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="hashCode():Int" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#hashCode():Int" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">def</span></span> <span class="symbol"><span class="name">hashCode</span><span class="params">()</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Int.html#scala.Int" name="scala.Int" id="scala.Int" class="extype">Int</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef → Any</dd><dt>Annotations</dt><dd><span class="name">@native</span><span class="args">()</span> </dd></dl></div></li><li class="indented0 " name="cats.effect.testkit.TestControl#isDeadlocked" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="isDeadlocked:cats.effect.IO[Boolean]" class="anchorToMember"></a><a id="isDeadlocked:IO[Boolean]" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#isDeadlocked:cats.effect.IO[Boolean]" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">val</span></span> <span class="symbol"><span class="name">isDeadlocked</span><span class="result">: <a href="../IO.html" name="cats.effect.IO" id="cats.effect.IO" class="extype">IO</a>[<a href="https://www.scala-lang.org/api/2.13.10/scala/Boolean.html#scala.Boolean" name="scala.Boolean" id="scala.Boolean" class="extype">Boolean</a>]</span></span><p class="shortcomment cmt">Produces <code>true</code> if the runtime has no remaining fibers, sleeping or otherwise, indicating
an asynchronous deadlock has occurred.</p><div class="fullcomment"><div class="comment cmt"><p>Produces <code>true</code> if the runtime has no remaining fibers, sleeping or otherwise, indicating
an asynchronous deadlock has occurred. Or rather, <i>either</i> an asynchronous deadlock, or
some interaction with an external asynchronous scheduler (such as another thread pool).
</p></div></div></li><li class="indented0 " name="scala.Any#isInstanceOf" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="isInstanceOf[T0]:Boolean" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#isInstanceOf[T0]:Boolean" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name">isInstanceOf</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Boolean.html#scala.Boolean" name="scala.Boolean" id="scala.Boolean" class="extype">Boolean</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>Any</dd></dl></div></li><li class="indented0 " name="scala.AnyRef#ne" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="ne(x$1:AnyRef):Boolean" class="anchorToMember"></a><a id="ne(AnyRef):Boolean" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#ne(x$1:AnyRef):Boolean" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name">ne</span><span class="params">(<span name="arg0">arg0: <a href="https://www.scala-lang.org/api/2.13.10/scala/AnyRef.html#scala.AnyRef" name="scala.AnyRef" id="scala.AnyRef" class="extype">AnyRef</a></span>)</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Boolean.html#scala.Boolean" name="scala.Boolean" id="scala.Boolean" class="extype">Boolean</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef</dd></dl></div></li><li class="indented0 " name="cats.effect.testkit.TestControl#nextInterval" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="nextInterval:cats.effect.IO[scala.concurrent.duration.FiniteDuration]" class="anchorToMember"></a><a id="nextInterval:IO[FiniteDuration]" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#nextInterval:cats.effect.IO[scala.concurrent.duration.FiniteDuration]" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">val</span></span> <span class="symbol"><span class="name">nextInterval</span><span class="result">: <a href="../IO.html" name="cats.effect.IO" id="cats.effect.IO" class="extype">IO</a>[<a href="https://www.scala-lang.org/api/2.13.10/scala/concurrent/duration/FiniteDuration.html#scala.concurrent.duration.FiniteDuration" name="scala.concurrent.duration.FiniteDuration" id="scala.concurrent.duration.FiniteDuration" class="extype">FiniteDuration</a>]</span></span><p class="shortcomment cmt">Produces the minimum time which must elapse for a fiber to become eligible for execution.</p><div class="fullcomment"><div class="comment cmt"><p>Produces the minimum time which must elapse for a fiber to become eligible for execution.
If fibers are currently eligible for execution, or if the program is entirely deadlocked,
the result will be <code>Duration.Zero</code>.
</p></div></div></li><li class="indented0 " name="scala.AnyRef#notify" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="notify():Unit" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#notify():Unit" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name">notify</span><span class="params">()</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Unit.html#scala.Unit" name="scala.Unit" id="scala.Unit" class="extype">Unit</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd><span class="name">@native</span><span class="args">()</span> </dd></dl></div></li><li class="indented0 " name="scala.AnyRef#notifyAll" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="notifyAll():Unit" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#notifyAll():Unit" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name">notifyAll</span><span class="params">()</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Unit.html#scala.Unit" name="scala.Unit" id="scala.Unit" class="extype">Unit</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd><span class="name">@native</span><span class="args">()</span> </dd></dl></div></li><li class="indented0 " name="cats.effect.testkit.TestControl#results" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="results:cats.effect.IO[Option[cats.effect.Outcome[cats.Id,Throwable,A]]]" class="anchorToMember"></a><a id="results:IO[Option[Outcome[Id,Throwable,A]]]" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#results:cats.effect.IO[Option[cats.effect.Outcome[cats.Id,Throwable,A]]]" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">val</span></span> <span class="symbol"><span class="name">results</span><span class="result">: <a href="../IO.html" name="cats.effect.IO" id="cats.effect.IO" class="extype">IO</a>[<a href="https://www.scala-lang.org/api/2.13.10/scala/Option.html#scala.Option" name="scala.Option" id="scala.Option" class="extype">Option</a>[<a href="../index.html#Outcome[F[_],E,A]=cats.effect.kernel.Outcome[F,E,A]" name="cats.effect.Outcome" id="cats.effect.Outcome" class="extmbr">Outcome</a>[<a href="../../index.html#Id[A]=A" name="cats.Id" id="cats.Id" class="extmbr">Id</a>, <span name="scala.Throwable" class="extype">Throwable</span>, <span name="cats.effect.testkit.TestControl.A" class="extype">A</span>]]]</span></span></li><li class="indented0 " name="cats.effect.testkit.TestControl#seed" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="seed:String" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#seed:String" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">def</span></span> <span class="symbol"><span class="name">seed</span><span class="result">: <span name="scala.Predef.String" class="extype">String</span></span></span><p class="shortcomment cmt">Returns the base64-encoded seed which governs the random task interleaving during each
<a href="#tick:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tick" id="cats.effect.testkit.TestControl#tick" class="extmbr">tick</a>.</p><div class="fullcomment"><div class="comment cmt"><p>Returns the base64-encoded seed which governs the random task interleaving during each
<a href="#tick:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tick" id="cats.effect.testkit.TestControl#tick" class="extmbr">tick</a>. This is useful for reproducing test failures which came about due to some
unexpected (though clearly plausible) execution order.
</p></div></div></li><li class="indented0 " name="scala.AnyRef#synchronized" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="synchronized[T0](x$1:=&gt;T0):T0" class="anchorToMember"></a><a id="synchronized[T0](=&gt;T0):T0" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#synchronized[T0](x$1:=&gt;T0):T0" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name">synchronized</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="params">(<span name="arg0">arg0: =&gt; <span name="java.lang.AnyRef.synchronized.T0" class="extype">T0</span></span>)</span><span class="result">: <span name="java.lang.AnyRef.synchronized.T0" class="extype">T0</span></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef</dd></dl></div></li><li class="indented0 " name="cats.effect.testkit.TestControl#tick" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="tick:cats.effect.IO[Unit]" class="anchorToMember"></a><a id="tick:IO[Unit]" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#tick:cats.effect.IO[Unit]" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">val</span></span> <span class="symbol"><span class="name">tick</span><span class="result">: <a href="../IO.html" name="cats.effect.IO" id="cats.effect.IO" class="extype">IO</a>[<a href="https://www.scala-lang.org/api/2.13.10/scala/Unit.html#scala.Unit" name="scala.Unit" id="scala.Unit" class="extype">Unit</a>]</span></span><p class="shortcomment cmt">Executes all pending fibers in a random order, repeating on new tasks enqueued by those
fibers until all pending fibers have been exhausted.</p><div class="fullcomment"><div class="comment cmt"><p>Executes all pending fibers in a random order, repeating on new tasks enqueued by those
fibers until all pending fibers have been exhausted. Does not result in the advancement of
time.
</p></div><dl class="attributes block"><dt>See also</dt><dd><span class="cmt"><p>
  <a href="#advance(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#advance" id="cats.effect.testkit.TestControl#advance" class="extmbr">advance</a></p></span><span class="cmt"><p>
  <a href="#tickAll:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tickAll" id="cats.effect.testkit.TestControl#tickAll" class="extmbr">tickAll</a></p></span></dd></dl></div></li><li class="indented0 " name="cats.effect.testkit.TestControl#tickAll" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="tickAll:cats.effect.IO[Unit]" class="anchorToMember"></a><a id="tickAll:IO[Unit]" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#tickAll:cats.effect.IO[Unit]" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">val</span></span> <span class="symbol"><span class="name">tickAll</span><span class="result">: <a href="../IO.html" name="cats.effect.IO" id="cats.effect.IO" class="extype">IO</a>[<a href="https://www.scala-lang.org/api/2.13.10/scala/Unit.html#scala.Unit" name="scala.Unit" id="scala.Unit" class="extype">Unit</a>]</span></span><p class="shortcomment cmt">Drives the runtime until all fibers have been executed, then advances time until the next
fiber becomes available (if relevant), and repeats until no further fibers are scheduled.</p><div class="fullcomment"><div class="comment cmt"><p>Drives the runtime until all fibers have been executed, then advances time until the next
fiber becomes available (if relevant), and repeats until no further fibers are scheduled.
Analogous to, though critically not the same as, running an <a href="../IO.html" name="cats.effect.IO" id="cats.effect.IO" class="extype">IO</a> on a single-threaded
production runtime.</p><p>This function will terminate for <code>IO</code>s which deadlock <i>asynchronously</i>, but any program
which runs in a loop without fully suspending will cause this function to run indefinitely.
Also note that any <code>IO</code> which interacts with some external asynchronous scheduler (such as
NIO) will be considered deadlocked for the purposes of this runtime.
</p></div><dl class="attributes block"><dt>See also</dt><dd><span class="cmt"><p>
  <a href="#tick:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tick" id="cats.effect.testkit.TestControl#tick" class="extmbr">tick</a></p></span></dd></dl></div></li><li class="indented0 " name="cats.effect.testkit.TestControl#tickFor" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="tickFor(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" class="anchorToMember"></a><a id="tickFor(FiniteDuration):IO[Unit]" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#tickFor(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">def</span></span> <span class="symbol"><span class="name">tickFor</span><span class="params">(<span name="time">time: <a href="https://www.scala-lang.org/api/2.13.10/scala/concurrent/duration/FiniteDuration.html#scala.concurrent.duration.FiniteDuration" name="scala.concurrent.duration.FiniteDuration" id="scala.concurrent.duration.FiniteDuration" class="extype">FiniteDuration</a></span>)</span><span class="result">: <a href="../IO.html" name="cats.effect.IO" id="cats.effect.IO" class="extype">IO</a>[<a href="https://www.scala-lang.org/api/2.13.10/scala/Unit.html#scala.Unit" name="scala.Unit" id="scala.Unit" class="extype">Unit</a>]</span></span><p class="shortcomment cmt">Drives the runtime incrementally forward until all fibers have been executed, or until the
specified <code>time</code> has elapsed.</p><div class="fullcomment"><div class="comment cmt"><p>Drives the runtime incrementally forward until all fibers have been executed, or until the
specified <code>time</code> has elapsed. The semantics of this function are very distinct from
<a href="#advance(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#advance" id="cats.effect.testkit.TestControl#advance" class="extmbr">advance</a> in that the runtime will tick for the minimum time necessary to reach the next
batch of tasks within each interval, and then continue ticking as long as necessary to
cumulatively reach the time limit (or the end of the program). This behavior can be seen in
programs such as the following:</p><pre><span class="kw">val</span> tick = IO.sleep(<span class="num">1.</span>second) *&gt; IO.realTime

TestControl.execute((tick, tick).tupled) flatMap { control <span class="kw">=&gt;</span>
  <span class="kw">for</span> {
    _ <span class="kw">&lt;-</span> control.tickFor(<span class="num">1.</span>second + <span class="num">500.</span>millis)
    _ <span class="kw">&lt;-</span> control.tickAll

    r <span class="kw">&lt;-</span> control.results
    _ <span class="kw">&lt;-</span> IO(assert(r == <span class="std">Some</span>(Outcome.succeeded(<span class="num">1.</span>second, <span class="num">2.</span>seconds))))
  } <span class="kw">yield</span> ()
}</pre><p>Notably, the first component of the results tuple here is <code>1.second</code>, meaning that the
first <code>IO.realTime</code> evaluated after the clock had <i>only</i> advanced by <code>1.second</code>. This is
in contrast to what would have happened with <code>control.advanceAndTick(1.second +
500.millis)</code>, which would have caused the first <code>realTime</code> to produce <code>2500.millis</code> as a
result, rather than the correct answer of <code>1.second</code>. In other words, <a href="#advanceAndTick(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#advanceAndTick" id="cats.effect.testkit.TestControl#advanceAndTick" class="extmbr">advanceAndTick</a> is
maximally aggressive on time advancement, while <code>tickFor</code> is maximally conservative and
only ticks as much as necessary each time.
</p></div><dl class="attributes block"><dt>See also</dt><dd><span class="cmt"><p>
  <a href="#tick:cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#tick" id="cats.effect.testkit.TestControl#tick" class="extmbr">tick</a></p></span><span class="cmt"><p>
  <a href="#advance(time:scala.concurrent.duration.FiniteDuration):cats.effect.IO[Unit]" name="cats.effect.testkit.TestControl#advance" id="cats.effect.testkit.TestControl#advance" class="extmbr">advance</a></p></span></dd></dl></div></li><li class="indented0 " name="cats.effect.testkit.TestControl#tickOne" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="tickOne:cats.effect.IO[Boolean]" class="anchorToMember"></a><a id="tickOne:IO[Boolean]" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#tickOne:cats.effect.IO[Boolean]" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">val</span></span> <span class="symbol"><span class="name">tickOne</span><span class="result">: <a href="../IO.html" name="cats.effect.IO" id="cats.effect.IO" class="extype">IO</a>[<a href="https://www.scala-lang.org/api/2.13.10/scala/Boolean.html#scala.Boolean" name="scala.Boolean" id="scala.Boolean" class="extype">Boolean</a>]</span></span><p class="shortcomment cmt">Executes a single pending fiber and returns immediately.</p><div class="fullcomment"><div class="comment cmt"><p>Executes a single pending fiber and returns immediately. Does not advance time. Produces
<code>false</code> if no fibers are pending.
</p></div></div></li><li class="indented0 " name="scala.AnyRef#toString" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="toString():String" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#toString():String" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">def</span></span> <span class="symbol"><span class="name">toString</span><span class="params">()</span><span class="result">: <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/lang/String.html#java.lang.String" name="java.lang.String" id="java.lang.String" class="extype">String</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div></li><li class="indented0 " name="scala.AnyRef#wait" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="wait():Unit" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#wait():Unit" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name">wait</span><span class="params">()</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Unit.html#scala.Unit" name="scala.Unit" id="scala.Unit" class="extype">Unit</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd><span class="name">@throws</span><span class="args">(<span><span class="defval">classOf[java.lang.InterruptedException]</span></span>)</span> </dd></dl></div></li><li class="indented0 " name="scala.AnyRef#wait" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="wait(x$1:Long,x$2:Int):Unit" class="anchorToMember"></a><a id="wait(Long,Int):Unit" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#wait(x$1:Long,x$2:Int):Unit" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name">wait</span><span class="params">(<span name="arg0">arg0: <a href="https://www.scala-lang.org/api/2.13.10/scala/Long.html#scala.Long" name="scala.Long" id="scala.Long" class="extype">Long</a></span>, <span name="arg1">arg1: <a href="https://www.scala-lang.org/api/2.13.10/scala/Int.html#scala.Int" name="scala.Int" id="scala.Int" class="extype">Int</a></span>)</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Unit.html#scala.Unit" name="scala.Unit" id="scala.Unit" class="extype">Unit</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd><span class="name">@throws</span><span class="args">(<span><span class="defval">classOf[java.lang.InterruptedException]</span></span>)</span> </dd></dl></div></li><li class="indented0 " name="scala.AnyRef#wait" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="wait(x$1:Long):Unit" class="anchorToMember"></a><a id="wait(Long):Unit" class="anchorToMember"></a> <span class="permalink"><a href="../../../cats/effect/testkit/TestControl.html#wait(x$1:Long):Unit" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">def</span></span> <span class="symbol"><span class="name">wait</span><span class="params">(<span name="arg0">arg0: <a href="https://www.scala-lang.org/api/2.13.10/scala/Long.html#scala.Long" name="scala.Long" id="scala.Long" class="extype">Long</a></span>)</span><span class="result">: <a href="https://www.scala-lang.org/api/2.13.10/scala/Unit.html#scala.Unit" name="scala.Unit" id="scala.Unit" class="extype">Unit</a></span></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd><span class="name">@throws</span><span class="args">(<span><span class="defval">classOf[java.lang.InterruptedException]</span></span>)</span> <span class="name">@native</span><span class="args">()</span> </dd></dl></div></li></ol></div></div><div id="inheritedMembers"><div name="scala.AnyRef" class="parent"><h3>Inherited from <a href="https://www.scala-lang.org/api/2.13.10/scala/AnyRef.html#scala.AnyRef" name="scala.AnyRef" id="scala.AnyRef" class="extype">AnyRef</a></h3></div><div name="scala.Any" class="parent"><h3>Inherited from <a href="https://www.scala-lang.org/api/2.13.10/scala/Any.html#scala.Any" name="scala.Any" id="scala.Any" class="extype">Any</a></h3></div></div><div id="groupedMembers"><div name="Ungrouped" class="group"><h3>Ungrouped</h3></div></div></div><div id="tooltip"></div><div id="footer"></div></body></div></div></div></body></html>
